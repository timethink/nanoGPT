import matplotlib.pyplot as plt

# 数据
tokens = [0, 16, 33, 49, 66, 82, 98, 115, 131, 147, 164, 180, 197, 213, 229, 246, 262, 278, 295, 311, 328, 344, 360, 377, 393, 410, 426, 442, 459, 475, 491, 508, 524, 541, 557, 573, 590, 606, 622, 639, 655, 672, 688, 704, 721, 737, 753, 770, 786, 803, 819]


# 各个embedding的loss和mfu数据
tokennizer_type = {
    1: {
        "mfu": [-100.0, 46.36014874477565, 46.24449727722797, 24.380062915933674, 17.708630754735402, 13.992779133331027, 16.36982820846119, 14.764312884674565, 13.501986893667564, 14.292576529991077, 13.090354679878535, 13.758570605745001, 13.863108823883085, 13.239432810988513, 13.868454317063245, 12.492666975356709, 13.750919217641272, 14.276552848425062, 13.39315163582604, 13.996238015773196, 12.626166684686819, 13.76450248948839, 14.070784263388546, 13.414952251466195, 14.048973799764003, 12.93476432389021, 13.778294179018902, 14.110732267502671, 13.518527255444459, 14.187469774725944, 12.895442330385409, 13.855815691041414, 14.191548456660499, 13.478078232284938, 14.053170248170389, 12.794162797983063, 13.741165067824706, 14.157254518519583, 13.447668190743475, 14.038456272207986, 12.799480942230856, 13.918945676253259, 14.27524369758941, 13.306811869881852, 13.786361646247109, 12.611353095491584, 13.793717327472427, 14.1597507312679, 13.339188747760675, 13.93559938011645, 12.846468345855108],
        "loss": [4.265376091003418, 2.4587464332580566, 2.2130651473999023, 1.8995110988616943, 1.764158010482788, 1.5959208011627197, 1.5113215446472168, 1.4830820560455322, 1.4295060634613037, 1.3725817203521729, 1.3407831192016602, 1.3232554197311401, 1.2916945219039917, 1.3022888898849487, 1.261331558227539, 1.192853331565857, 1.1963553428649902, 1.1795036792755127, 1.1789544820785522, 1.1345036029815674, 1.1293754577636719, 1.1383178234100342, 1.1259493827819824, 1.121462106704712, 1.0763118267059326, 1.0811100006103516, 1.0656872987747192, 1.0242944955825806, 1.0140771865844727, 0.9929502606391907, 0.9866762757301331, 0.9853479266166687, 0.969260573387146, 0.9489510655403137, 0.9558317065238953, 0.9115849733352661, 0.9292722940444946, 0.8681187033653259, 0.9078800678253174, 0.8946819305419922, 0.8642863035202026, 0.9051227569580078, 0.8489572405815125, 0.8339557647705078, 0.8435392379760742, 0.8543099164962769, 0.825637698173523, 0.8211883306503296, 0.821574866771698, 0.8040120005607605, 0.8235878348350525]
    },
    2: {
        "mfu": [-100.0, 13.780693544078689, 14.084627962448822, 12.797350293685403, 13.191404185201023, 13.286447371125698, 16.48721562394954, 14.832519601529448, 12.75001040137684, 12.97221064768096, 14.29564184345817, 16.677520840129265, 13.857841571059081, 12.16796746613367, 12.992972643825103, 11.469173330951989, 12.216463867662155, 12.758480190674518, 12.356987662706976, 12.66559357990199, 11.297378121042986, 12.211904642505221, 12.69034666523968, 11.779310957833294, 12.101811361666966, 11.610189445967203, 12.59001528878426, 12.344923885675959, 11.7154676741873, 12.83152074273283, 11.23827129965614, 21.990949089873734, 25.94363711337636, 25.623763046057473, 27.24391007510575, 24.976293206769075, 26.87337234426152, 27.657301870737633, 26.29286954939132, 27.382289572645114, 24.90750651161187, 26.924356934072325, 27.561150149972875, 26.12712839952629, 27.401733843112858, 25.02603847916719, 26.987028485918195, 27.596645999378243, 26.182731744608045, 27.29618550580367, 25.00180649889715],
        "loss": [9.88918685913086, 5.33197021484375, 4.645703315734863, 4.178395748138428, 3.7125449180603027, 3.3247439861297607, 2.7404944896698, 2.248460292816162, 1.8696626424789429, 1.5624349117279053, 1.2758066654205322, 1.2081947326660156, 1.0603106021881104, 0.951958179473877, 0.8678402304649353, 0.8008034229278564, 0.7182403206825256, 0.6945921778678894, 0.627429187297821, 0.5661762356758118, 0.5107307434082031, 0.536047101020813, 0.48604559898376465, 0.4657517075538635, 0.4468686580657959, 0.39612919092178345, 0.39489948749542236, 0.3826693892478943, 0.362127423286438, 0.3473414182662964, 0.32578909397125244, 0.3038617968559265, 0.29008084535598755, 0.27593886852264404, 0.2632521390914917, 0.25471556186676025, 0.2517271339893341, 0.22679802775382996, 0.23725858330726624, 0.22171711921691895, 0.2231203019618988, 0.21476992964744568, 0.20617598295211792, 0.20207622647285461, 0.209778293967247, 0.20768046379089355, 0.19303926825523376, 0.20466028153896332, 0.19132784008979797, 0.19129446148872375, 0.18738389015197754]
    },
}

# 绘图
plt.figure(figsize=(14, 8))

# 绘制损失曲线
for type, data in tokennizer_type.items():
    plt.plot(tokens[1:], data["loss"][1:], label=f'Tokenizer Type: {type} Loss', marker='o')

# 添加图例和标签
plt.title('Loss vs. Tokens')
plt.xlabel('Tokens')
plt.ylabel('Loss')
plt.grid()
plt.legend()

# 保存损失图
plt.savefig('loss_vs_tokens.png')
plt.show()

# 创建新图形
plt.figure(figsize=(14, 8))

# 绘制MFU曲线
for type, data in tokennizer_type.items():
    plt.plot(tokens[1:], data["mfu"][1:], label=f'Tokenizer Type: {type} MFU', marker='o')

# 添加图例和标签
plt.title('MFU vs. Tokens')
plt.xlabel('Tokens')
plt.ylabel('MFU')
plt.grid()
plt.legend()

# 保存MFU图
plt.savefig('mfu_vs_tokens.png')
plt.show()
